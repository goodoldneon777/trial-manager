var m_search={};m_search.start=function(){"use strict";m_search.watch()},m_search.watch=function(){"use strict";$(".m_search .name").keyup(function(){m_search.submit()}),$(".m_search input").change(function(){m_search.submit()}),$(".m_search select").change(function(){m_search.submit()}),$(".m_search .c_submitBtn").click(function(){m_search.submit()})},m_search.validate=function(){"use strict";var a="",b=$(".m_search .start-date input").val(),c=$(".m_search .end-date input").val();return b.length>0&&!isValidDate(b)&&(a+="<li>'Start Date' is not a valid date.</li>"),c.length>0&&!isValidDate(c)&&(a+="<li>'End Date' is not a valid date.</li>"),b.length>0&&c.length>0&&isValidDate(b)&&isValidDate(c)&&(b=stringToDate(b),c=stringToDate(c),b>c&&(a+="<li>'Start Date' is after 'End Date'</li>")),a},m_search.parse=function(){"use strict";var a={name:prepForSQL($(".m_search .c_form .name input").val()),startDate:prepForSQL($(".m_search .c_form .start-date input").val(),"date"),endDate:prepForSQL($(".m_search .c_form .end-date input").val(),"date"),unit:prepForSQL($(".m_search .c_form .unit select").val()),goalType:prepForSQL($(".m_search .c_form .goal-type select").val()),changeType:prepForSQL($(".m_search .c_form .change-type select").val())};return a},m_search.submit=function(){var a="",b="";a=m_search.validate(),0===a.length?($(".m_search .c_errorBox .content").html(""),m_search.search()):(b='<h3>Please fix these items:</h3><div class="errorList">  <ul>'+a+"</ul></div>",BootstrapDialog.alert({title:'<span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span>&nbsp;&nbsp;Error',type:BootstrapDialog.TYPE_DANGER,message:b}),a='<div class="alert alert-danger">    <ul>'+a+"</ul></div>",$(".m_search .c_errorBox .content").html(a))},m_search.search=function(){"use strict";var a=m_search.parse(),b=getURLVariable("type");"group"!==b&&(b="trial"),$.ajax({type:"POST",url:gVar.root+"/module/search/dist/sql_search.php",data:{input:JSON.stringify(a),pageType:JSON.stringify(b)},dataType:"json",success:function(a){$(".m_search .c_results").html(a.html)},error:function(a,b,c){var d=new BootstrapDialog({title:'<span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span>&nbsp;&nbsp;Error',type:BootstrapDialog.TYPE_DANGER,message:"Status: "+b+"\nError: "+c,buttons:[{label:"OK",action:function(a){a.close()}}]});d.open()}})},$(document).ready(function(){m_search.start()});