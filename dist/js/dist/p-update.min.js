$(document).ready(function(){"use strict";function a(){b(),c()}function b(){h={}}function c(){$("#submit").click(function(){d()}),$("#delete").click(function(){e()})}function d(){var a="",b="";"trial"===k?(a+=m_info_trial.validate(),a+=m_heatData_trial.validate()):"group"===k&&(a+=m_info_group.validate()),0===a.length?($(".errorHolder").html(""),"trial"===k?f("trial"):"group"===k&&f("group")):(b='<h3>Please fix these items:</h3><div class="errorList">  <ul>'+a+"</ul></div>",BootstrapDialog.alert({title:'<span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span>&nbsp;&nbsp;Error',type:BootstrapDialog.TYPE_DANGER,message:b}),a='<div class="alert alert-danger">\n    <ul>\n'+a+"</ul>\n</div>",$(".errorHolder").html(a))}function e(){BootstrapDialog.confirm({title:'<span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span>&nbsp;&nbsp;Warning',type:BootstrapDialog.TYPE_WARNING,message:'<h3 style="text-align:center;">This will permanently delete the trial. \n \nAre you sure?</h3>',closable:!1,callback:function(a){a&&("trial"===k?g("trial"):"group"===k&&g("group"))}})}function f(a){var b=null,c={},d=[],e=[],f={},g=null,h=null,k=null,l=null;"trial"===a?(b=i,c=m_info_trial.parse(),e=m_commentList.parse(),f=m_heatData_trial.parse(),g="php/dist/sql-update-trial.php",h="view.php?trialseq=",k="Trial successfully updated.",l="Something went wrong. Trial not updated."):"group"===a&&(b=j,c=m_info_group.parse(),d=m_childList_group.parse(),e=m_commentList.parse(),g="php/dist/sql-update-group.php",h="view.php?groupseq=",k="Group successfully update.",l="Something went wrong. Group not updated."),console.log(d),$.ajax({type:"POST",url:g,data:{seq:JSON.stringify(b),info:JSON.stringify(c),childTrialList:JSON.stringify(d),commentList:JSON.stringify(e),heatData:JSON.stringify(f)},dataType:"json",success:function(a){if("success"===a.status){var b=new BootstrapDialog({title:'<span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>&nbsp;&nbsp;Success',type:BootstrapDialog.TYPE_SUCCESS,message:'<h3 style="text-align:center;">'+k+"</h3>",buttons:[{label:"OK",action:function(){b.close(),document.location.href=h+a.seq}}]});b.open()}else{var b=new BootstrapDialog({title:'<span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span>&nbsp;&nbsp;Error',type:BootstrapDialog.TYPE_DANGER,message:'<h3 style="text-align:center;">'+l+"</h3>",buttons:[{label:"OK",action:function(a){b.close()}}]});b.open(),console.log(a.errors),console.log(a.debugSQL)}},error:function(a,b,c){var d=new BootstrapDialog({title:'<span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span>&nbsp;&nbsp;Error',type:BootstrapDialog.TYPE_DANGER,message:"Status: "+b+"\nError: "+c,buttons:[{label:"OK",action:function(a){d.close()}}]});d.open()}})}function g(a){var b=null,c=null,d=null,e=null,f=null;"trial"===a?(b=i,c="php/dist/sql-delete-trial.php",d="index.php",e="Trial successfully deleted.",f="Something went wrong. Trial not deleted."):"group"===a&&(b=j,c="php/dist/sql-delete-group.php",d="index.php",e="Group successfully deleted.",f="Something went wrong. Group not deleted."),$.ajax({type:"POST",url:c,data:{seq:prepForSQL(b)},dataType:"json",success:function(a){if("success"===a.status){var b=new BootstrapDialog({title:'<span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>&nbsp;&nbsp;Success',type:BootstrapDialog.TYPE_SUCCESS,message:'<h3 style="text-align:center;">'+e+"</h3>",buttons:[{label:"OK",action:function(){document.location.href="index.php"}}]});b.open()}else{var b=new BootstrapDialog({title:'<span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span>&nbsp;&nbsp;Error',type:BootstrapDialog.TYPE_DANGER,message:'<h3 style="text-align:center;">'+f+"</h3>",buttons:[{label:"OK",action:function(a){a.close()}}]});b.open(),console.log(a.errors)}},error:function(a,b,c){var d=new BootstrapDialog({title:'<span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span>&nbsp;&nbsp;Error',type:BootstrapDialog.TYPE_DANGER,message:"Status: "+b+"\nError: "+c,buttons:[{label:"OK",action:function(a){a.close()}}]});d.open()}})}var h={},i=getURLVariable("trialseq"),j=getURLVariable("groupseq"),k="";k=j?"group":"trial",a()});